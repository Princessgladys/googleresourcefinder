{% comment %}
# Copyright 2009-2010 by Ka-Ping Yee
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
{% endcomment %}

<!-- No doctype: need quirks mode to get scrollbars in IE. -->
<head>
  <title>Resource Mapper ({{instance}})</title>
    <link rel="stylesheet" href="static/map.css">
  {% if params.print %}
    <link rel="stylesheet" href="static/map-print.css">
  {% endif %}
  <!--[if lt IE 8]>
    <link rel="stylesheet" href="static/map-ie.css">
  <![endif]-->
  <script type="text/javascript"
      src="http://maps.google.com/maps/api/js?sensor=false">
  </script>
  <script type="text/javascript" src="static/jquery.min.js">
  </script>
  <script type="text/javascript" src="static/jquery.form.js"></script>
  <script type="text/javascript">
    // Do we have a namespace already?
    // shouldn't
    // rmapper =  rmapper || {};
    // work? it fails for me

    rmapper = {};
    {% if user %}
      rmapper.user = {};
      rmapper.user.email = '{{ user.email|escape }}';
      rmapper.user.is_editor = function() {
        return {% if is_editor %} true {% else %} false {% endif %};
      }
    {% endif %}
    
  </script>
  <script type="text/javascript">
    var print = {% if params.print %} true {% else %} false {% endif %};
    jQuery(document).ready(function() {
      jQuery.noConflict();
      jQuery.getScript('static/map.js', function() {
        load_data({{data}});
      });
    });
  </script>

</head>

<div id="viewport"></div>
<div class="header">
  <div class="user">
    <strong>{{authorization}}</strong> |
    {% if params.print %}
      <a href="/">Home</a> |
    {% else %}
      <a href="/?print=yes">Print</a> |
    {% endif %}
    <a href="about:blank">Help</a> |
    <a href="{{loginout_url}}">{{loginout_text}}</a>
  </div>
  <div class="title">
    Resource Mapper
  </div>
</div>
<div id="print-timestamp"></div>
<div id="map"></div>
<div class="hshadow hs1"></div>
<div class="hshadow hs2"></div>
<div class="hshadow hs3"></div>
<div class="vshadow vs1"></div>
<div class="vshadow vs2"></div>
<div class="vshadow vs3"></div>
<div id="data">
  <div id="supply-section" class="section">
    <div class="table-head">
      <table width="100%" cellspacing=0 cellpadding=0 border=0>
        <thead id="supply-thead">
          <tr>
            <th>Supplies</th>
          </tr>
        </thead>
      </table>
    </div>
    <div class="table-body">
      <table width="100%" cellspacing=0 cellpadding=0 border=0>
        <tbody id="supply-tbody"></tbody>
      </table>
    </div>
  </div>
  <div id="filter-section" class="section">
    <div class="table-head">
      <table width="100%" cellspacing=0 cellpadding=0 border=0>
        <thead id="filter-thead">
          <tr>
            <th>Filters</th>
          </tr>
        </thead>
      </table>
    </div>
    <div class="table-body">
      <table width="100%" cellspacing=0 cellpadding=0 border=0>
        <tbody id="filter-tbody"></tbody>
      </table>
    </div>
  </div>
  <div id="legend-section" class="section">
    <div class="table-body">
      <table width="100%" cellspacing=0 cellpadding=0 border=0>
        <tbody id="legend-tbody"></tbody>
      </table>
    </div>
  </div>
  <div id="division-section" class="section">
    <div class="table-head">
      <table width="100%" cellspacing=0 cellpadding=0 border=0>
        <thead id="division-thead">
          <tr>
            <th>Arrondissements</th>
          </tr>
        </thead>
      </table>
    </div>
    <div class="table-body" id="division-list">
      <table width="100%" cellspacing=0 cellpadding=0 border=0>
        <tbody id="division-tbody"></tbody>
      </table>
    </div>
  </div>
  <div id="facility-section" class="section">
    <div class="table-head">
      <table width="100%" cellspacing=0 cellpadding=0 border=0>
        <thead id="facility-thead">
          <tr>
            <th>Facility</th>
          </tr>
        </thead>
      </table>
    </div>
    <div class="table-body" id="facility-list">
      <table width="100%" cellspacing=0 cellpadding=0 border=0>
        <tbody id="facility-tbody">
        </tbody>
      </table>
    </div>
  </div>
</div>
<div id="freshness" class="caption"></div>
{% if params.print %}
  <div id="update-instructions">
    If any information is wrong or missing,
    please correct it on the web site: <span id="site-url"></span>
  </div>
{% endif %}
